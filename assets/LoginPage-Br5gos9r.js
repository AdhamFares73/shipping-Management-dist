import{_ as h,R as v,x as k,r as c,v as p,c as l,o as i,a as t,a0 as S,A as F,u as m,m as u,b as V,d as n,t as N}from"./index-CDQ06i05.js";import{_ as P}from"./failer-Dtv5Mqu6.js";import{c as j,a as f,u as A}from"./index.esm-DncBc-sR.js";import{_ as x}from"./InputField.vue_vue_type_script_setup_true_lang-C1270Y12.js";const B={class:"w-full h-full bg-[#F8F8F8] flex justify-start items-center flex-col lg:px-8"},E={class:"bg-white p-8 rounded-[12px] gap-y-2 my-auto flex flex-col w-full max-w-xl"},L={class:"flex flex-col gap-y-1 pt-3"},R={key:0,class:"bg-red-100 rounded-[12px] flex gap-2 py-3 mt-4 px-4 items-center text-sm text-start"},T={class:"flex justify-end items-center w-full mt-4"},$=["disabled"],q={key:0,class:""},M={key:1},C={__name:"LoginPage",setup(D){const a=v(),g=k(),o=c(""),r=c(!1),w=j({email:f().required("البريد الالكتروني مطلوب"),password:f().required("كلمة المرور مطلوبة")}),{handleSubmit:y}=A({validationSchema:w,initialValues:{email:"",password:""}}),d=y(async e=>{r.value=!0,o.value="";try{const s=await p.post("users/login/",{email:e.email,password:e.password});a.setAccessToken(s.data.access),a.setRefreshToken(s.data.refresh),await _(),g.push({name:a.role==="owner"?"dashboard-home":"dashboard-shipmentslist"})}catch(s){o.value="البريد الالكتروني أو كلمة المرور غير صحيحة",console.log("Login error:",s)}finally{r.value=!1}}),_=async()=>{try{const e=await p.get("users/profile/");a.setUser(e.data)}catch(e){console.log("Profile error:",e)}};return(e,s)=>(i(),l("div",B,[s[6]||(s[6]=t("div",{class:"py-5 flex items-start w-full px-3 justify-start"},[t("img",{src:S,alt:"logo",class:"w-40"})],-1)),t("div",E,[s[4]||(s[4]=t("h1",{class:"text-xl font-bold text-start"},"تسجيل الدخول",-1)),s[5]||(s[5]=t("p",{class:"text-[#494949] text-sm text-start"}," ادخل اسم المستخدم وكلمة المرور ",-1)),t("form",{action:"",onSubmit:s[0]||(s[0]=F((...b)=>m(d)&&m(d)(...b),["prevent"]))},[t("div",L,[s[2]||(s[2]=t("label",{for:"email",class:"text-gray-700 text-sm text-start w-full"},[n(" البريد الالكتروني "),t("span",{class:"text-red-500"},"*")],-1)),u(x,{name:"email",type:"text",placeholder:"البريد الالكتروني",class:"mt-2"}),s[3]||(s[3]=t("label",{for:"password",class:"text-gray-700 text-sm text-start mt-4"},[n("كلمة المرور "),t("span",{class:"text-red-500"},"*")],-1)),u(x,{name:"password",type:"password",placeholder:"كلمة المرور",class:"mt-2"}),o.value?(i(),l("span",R,[s[1]||(s[1]=t("img",{src:P,alt:"",class:"h-6"},null,-1)),n(" "+N(o.value),1)])):V("",!0),t("div",T,[t("button",{class:"w-[200px] px-4 py-2 disabled:opacity-50 disabled:cursor-not-allowed text-white bg-[#0E5895] rounded-md focus:outline-none focus:shadow-outline",disabled:r.value,type:"submit"},[r.value?(i(),l("span",q," جاري التسجيل ")):(i(),l("span",M,"تسجيل الدخول"))],8,$)])])],32)])]))}},H=h(C,[["__scopeId","data-v-6bb49f82"]]);export{H as default};
